<div class="container">
	<div class="row">
		<div class="col-xs-8">
			<h2 class="section-headline">
				<span>Checkout</span>
			</h2>
		</div>
		<div class="col-xs-4">
			<img src="../../../assets/image/logo.png" class="img-responsive right" style="width:400px;z-index:1;" />
		</div>
		<img src="../../../assets/image/wood.png" class="img-responsive right" style="position:absolute;margin-top:90px;z-index:-2;" />
	</div>
	<hr style="position:absolute;width:85%;height:6px;background-color:#333;z-index:-1;margin-top:-170px;" />
	
	<div class="row" style="margin-top:120px;">
		<form (ngSubmit)="onSubmit()" method="post">
			<div class="col-xs-4">
				<div class="panel panel-default">
					<div class="panel-body">
						<button mat-raised-button type="submit" class="btn-block mat-primary">Place your order</button>
						<p style="font-size:smaller;">By placing your order, you agree to Yu's Bookstore's terms & condition.</p>
						<hr />
						<h3>Order Summary</h3>
						<div class="row">
							<div class="col-xs-7 text-left">
								Total before tax:
							</div>
							<div class="col-xs-5 text-right">
								$<span style="color:#db3208;">{{shoppingCart.grandTotal}}</span>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-7 text-left">
								Estimated tax:
							</div>
							<div class="col-xs-5 text-right">
								$<span style="color:#db3208;">{{shoppingCart.grandTotal * 0.0625 | number: '1.2-2'}}</span>
							</div>
						</div>
						<div class="row">
							<div class="col-xs-7 text-left">
								<h3 style="color:darkred;"><strong>Order Total: </strong></h3>
							</div>
							<div class="col-xs-5 text-right">
								<h3><strong style="color:darkred;">
									$<span style="color:#db3208;">{{shoppingCart.grandTotal * 1.0625 | number: '1.2-2'}}</span>
								</strong></h3>
							</div>
						</div>
					</div>
					<div class="panel-footer">
						Shipping and handling haven't applied.
					</div>
				</div>
			</div>
			<div class="col-xs-8">
				<div *ngIf="missingRequiredField">
					<h5 class="alert alert-warning">There are some fields missing. Fields with * is required.</h5>
				</div>
				<mat-tab-group (selectedIndexChange)="selectedChange($event)" [selectedIndex]="selectedTab">
					<!-- 1. Shipping Address -->
					<mat-tab label="1. Shipping Address">
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">1. Shipping Address</h4>
							</div>
							<div class="panel-body">
								<table class="table" *ngIf="!emptyShippingList">
									<thead>
										<tr>
											<th>Available Shipping Address</th>
											<th>Operation</th>
										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let userShipping of userShippingList">
											<td>{{userShipping.userShippingStreet1}} {{userShipping.userShippingStreet2}},{{userShipping.userShippingCity}},{{userShipping.userShippingState}} {{userShipping.userShippingZipcode}}</td>
											<td>
												<a class="pointer" (click)="setShippingAddress(userShipping)">Use this address</a>
											</td>
										</tr>
									</tbody>
								</table>
								<div class="form-group">
									<label for="shippingName">* Name</label>
									<input type="text" class="form-control" id="shippingAddressName" placeholder="Receiver Name" name="shippingAddressName" required="required" [(ngModel)]="shippingAddress.userShippingName" />
								</div>
								<div class="form-group">
									<label for="streetAddress">* Street Address</label>
									<input type="text" class="form-control" id="streetAddress" placeholder="Street Address 1" name="shippingAddressStreet1" required="required" [(ngModel)]="shippingAddress.userShippingStreet1" />
								</div>
								<div class="form-group">
									<input type="text" class="form-control" placeholder="Street Address 2" name="shippingAddressStreet2" [(ngModel)]="shippingAddress.userShippingStreet2" />
								</div>
								<div class="row">
									<div class="col-xs-4">
										<div class="form-group">
											<label for="ShippingCity">* City</label>
											<input type="text" class="form-control" id="shippingAddressCity" placeholder="Your Shipping City" name="shippingAddressCity" required="required" [(ngModel)]="shippingAddress.userShippingCity" />
										</div>
									</div>
									<div class="col-xs-4">
										<div class="form-group">
											<label for="shippingState">* State</label>
											<select type="text" class="form-control" id="shippingAddressState" name="shippingAddressState" required="required" [(ngModel)]="shippingAddress.userShippingState">
												<option value="" disabled>-- State --</option>
												<option *ngFor="let state of stateList">{{state}}</option>
											</select>
										</div>
									</div>
									<div class="col-xs-4">
										<div class="form-group">
											<label for="shippingZipcode">* Zipcode</label>
											<input type="text" class="form-control" id="shippingAddressZipcode" placeholder="Zipcode" name="shippingAddressZipcode" required="required" [(ngModel)]="shippingAddress.userShippingZipcode" />
										</div>
									</div>
								</div>
								<a mat-raised-button class="mat-primary" (click)="goToPayment()">Next</a>
							</div>
						</div>
					</mat-tab>
					<!-- 2. Payment Information -->
					<mat-tab label="2. Payment Information">
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">2. Payment Information</h4>
							</div>
							<div class="panel-body">
								<table class="table" *ngIf="!emptyPaymentList">
									<thead>
										<tr>
											<th>Available Credit Card</th>
											<th>Operation</th>
										</tr>
									</thead>
									<tbody>
										<tr *ngFor="let userPayment of userPaymentList">
											<td>{{userPayment.cardName}}</td>
											<td>
												<a class="pointer" (click)="setPaymentMethod(userPayment)">Use this card</a>
											</td>
										</tr>
									</tbody>
								</table>
								<!-- Credit Card Info -->
								<div class="row">
									<div class="col-xs-12">
										<img src="../../../assets/image/creditcard.png" class="img-responsive" />
										<br />
										<div class="form-group">
											<label for="cardType">*Select Card Type</label>
											<select type="text" class="form-control" id="cardType" name="cardType" required="required" [(ngModel)]="payment.type">
												<option value="" disabled>-- Card Type --</option>
												<option value="visa">Visa</option>
												<option value="mastercard">Mastercard</option>
												<option value="discover">Discover</option>
												<option value="amex">American Express</option>
											</select>
										</div>
										<div class="form-group">
											<label for="cardholder">* Card Holder</label>
											<input type="text" class="form-control" id="cardholder" placeholder="Card Holder Name" name="cardholderName" required="required" [(ngModel)]="payment.holderName" />
										</div>
										<div class="form-group">
											<label for="cardNumber">* Card Number</label>
											<div class="input-group">
												<input type="tel" class="form-control" id="cardNumber" placeholder="Valid Card Number" name="cardNumber" required="required" [(ngModel)]="payment.cardNumber" />
												<span class="input-group-addon"><i class="fa fa-credit-card"></i></span>
											</div>
										</div>
									</div>
								</div>
								<div class="row">
									<div class="col-xs-7">
										<div class="form-group">
											<label>* Expiration Date</label>
											<div class="row">
												<div class="col-xs-6">
													<select type="text" class="form-control" name="expiryMonth" required="required" [(ngModel)]="payment.expiryMonth">
														<option value="" disabled>-- Month --</option>
														<option value="1">Jan (01)</option>
														<option value="2">Feb (02)</option>
														<option value="3">Mar (03)</option>
														<option value="4">Apr (04)</option>
														<option value="5">May (05)</option>
														<option value="6">Jun (06)</option>
														<option value="7">July (07)</option>
														<option value="8">Aug (08)</option>
														<option value="9">Sep (09)</option>
														<option value="10">Oct (10)</option>
														<option value="11">Nov (11)</option>
														<option value="12">Dec (12)</option>
													</select>
												</div>
												<div class="col-xs-6">
													<select type="text" class="form-control" name="expiryYear" required="required" [(ngModel)]="payment.expiryYear">
														<option value="" disabled>-- Year --</option>
														<option *ngFor="let year of yearList" [value]="year.value">{{year.year}}</option>
													</select>
												</div>
											</div>
										</div> 
									</div>
									<div class="col-xs-5 pull-right">
										<div class="form-group">
											<label for="cardCVC">* CV Code</label>
											<input id="cardCVC" type="tel" class="form-control" name="cardCVC" placeholder="CVC" [(ngModel)]="payment.cvc" />
										</div>
									</div>
								</div>
								<div class="checkbox">
									<label>
										<input id="theSameAsShippingAddress" type="checkbox" name="billingSameAsShipping" value="true" (click)="setBillingAsShipping($event.target.checked)" />The same as shipping address
									</label>
									<!-- Billing Address -->
									<div class="form-group">
										<label for="billingName">* Name</label>
										<input type="text" class="form-control" id="billingAddressName" placeholder="Receiver Name" name="billingAddressName" required="required" [(ngModel)]="billingAddress.userBillingName" />
									</div>
									<div class="form-group">
										<label for="billingAddress">* Street Address</label>
										<input type="text" class="form-control" id="billingAddress" placeholder="Street Address 1" name="billingAddressStreet1" required="required" [(ngModel)]="billingAddress.userBillingStreet1" />
									</div>
									<div class="form-group">
										<input type="text" class="form-control" placeholder="Street Address 2" name="billingAddressStreet2" [(ngModel)]="billingAddress.userBillingStreet2" />
									</div>
									<div class="row">
										<div class="col-xs-4">
											<div class="form-group">
												<label for="billingCity">* City</label>
												<input type="text" class="form-control" id="billingAddressCity" placeholder="Your Billing City" name="billingAddressCity" required="required" [(ngModel)]="billingAddress.userBillingCity" />
											</div>
										</div>
										<div class="col-xs-4">
											<div class="form-group">
												<label for="billingState">* State</label>
												<select type="text" class="form-control" id="billingAddressState" name="billingAddressState" required="required" [(ngModel)]="billingAddress.userBillingState">
													<option value="" disabled>-- State --</option>
													<option *ngFor="let state of stateList">{{state}}</option>
												</select>
											</div>
										</div>
										<div class="col-xs-4">
											<div class="form-group">
												<label for="billingZipcode">* Zipcode</label>
												<input type="text" class="form-control" id="billingAddressZipcode" placeholder="Zipcode" name="billingAddressZipcode" required="required" [(ngModel)]="billingAddress.userBillingZipcode" />
											</div>
										</div>
									</div>
									<a mat-raised-button class="mat-primary" (click)="goToReview()">Next</a>
								</div>
							</div>
						</div>
					</mat-tab>
					<!-- 3. Review Items and Shipping -->
					<mat-tab label="3. Review">
						<div class="panel panel-default">
							<div class="panel-heading">
								<h4 class="panel-title">3. Review Items and Shipping</h4>
							</div>
							<div class="panel-body">
								<h4>Choose your shipping method:</h4>
								<div class="radio">
									<label>
										<input type="radio" name="shippingMethod" value="groundShipping" [(ngModel)]="shippingMethod" />Groud Shipping
									</label>
								</div>
								<div class="radio">
									<label>
										<input type="radio" name="shippingMethod" value="premiumShipping" [(ngModel)]="shippingMethod" />Premuim Shipping
									</label>
								</div>
								<div class="row">
									<div class="col-xs-8">
										<h4>Products</h4>
									</div>
									<div class="col-xs-2">
										<h4>Price</h4>
									</div>
									<div class="col-xs-2">
										<h4>Qty</h4>
									</div>
								</div>
								<!-- Display Products -->
								<div class="row" *ngFor="let cartItem of cartItemList">
									<hr />
									<div class="col-xs-2">
										<a mat-button (click)="onSelect(cartItem.book)">
											<img class="img-responsive" src="{{serverPath}}/image/book/{{cartItem.book.bookId}}.png" style="width:70px;" />
										</a>
									</div>
									<div class="col-xs-6">
										<a class="pointer" (click)="onSelect(cartItem.book)">
											<h4>{{cartItem.book.title}}</h4>
										</a>
										<p *ngIf="cartItem.book.inStockNumber>=10" style="color:green;">In Stock</p>
										<p *ngIf="cartItem.book.inStockNumber<10 && cartItem.book.inStockNumber>0" style="color:yellow;">Only <span>{{cartItem.book.inStockNumber}}</span> In Stock</p>
										<p *ngIf="cartItem.book.inStockNumber==0" style="color:darkred;">Product Unavailable.</p>
										<a class="pointer" (click)="onRemoveCartItem(cartItem)"><i class="fa fa-times"></i>Delete</a>
									</div>
									<div class="col-xs-2">
										<h5 style="color:#db3208;font-size:large;">$<span [ngClass]="{'text-strike':cartItem.book.inStockNumber==0}">{{cartItem.book.ourPrice | number : '1.2-2'}}</span></h5>
									</div>
									<div class="col-xs-2 text-center">
										<h5 style="font-size:large;">{{cartItem.qty}}</h5>
									</div>
								</div>
								<div class="row">
									<hr />
									<h4 class="col-xs-12 text-right">
										<strong style="font-size:large;">Total Price (<span>{{cartItemNumber}}</span> items): </strong><span style="color:#db3208;font-size:large;">$<span>{{shoppingCart.grandTotal}}</span></span> 
									</h4>
									<br />
									<br />
									<button mat-raised-button type="submit" class="btn-block mat-primary">Place your order</button>
									<p>By placing your order, you agree to Yu's Bookstore's terms & conditions.</p>
								</div>
							</div>
						</div>
					</mat-tab>
				</mat-tab-group>
			</div>
		</form>
	</div>
</div>